IF OBJECT_ID('tempdb..#rtemp') IS NOT NULL
    DROP TABLE #rtemp;
select  a.loan_skey,
--a.original_loan_number, 
a.loan_sub_status_description as loan_sub_status,a.investor_name,a.loan_status_description,
c.contact_type_description as 'CONTACTTYPE1'
,c.first_name as 'CONTACTFIRSTNAME1',c.last_name as 'CONTACTLASTNAME1' 
,b.address1 as 'Property Address1',b.address2 as 'Property Address2' ,b.city as 'Property City' 
,b.state_code as 'Property State',left(b.zip_code,5) as 'Property Zip'
,c.mail_address1 as 'Mailing Address 1' ,c.mail_address2 as 'Mailing Address 2',c.mail_city as 'Mailing City'
,c.mail_state_code as 'Mailing State' ,left(c.mail_zip_code,5) as 'Mailing Zip',c.home_phone_number as 'HOMEPHONE1',c.cell_phone_number as 'CELLPHONE1'
,c.work_phone_number as 'Work Phone #'
--,b.curtailment_reason_description,b.date_foreclosure_sale_held,b.date_foreclosure_sale_scheduled
,d.alert_type_description
,d.alert_status_description
/*,case when c.contact_type_description = 'Attorney' then 1
	  when c.contact_type_description = 'Borrower' then 2
	  when c.contact_type_description = 'Co-Borrower' then 3
	  when c.contact_type_description = 'Legal Owner' then 5
	  when c.contact_type_description = 'Entitled Non-Borrowing Spouse' then 6
	  when c.contact_type_description = 'Alternate Contact' then 14
	  when c.contact_type_description = 'Authorized Party' then 12
	  when c.contact_type_description = 'Executor' then 7
	  when c.contact_type_description = 'Power of Attorney' then 8
	  when c.contact_type_description = 'Trustee' then 11
	  when c.contact_type_description = 'Non-Borrowing Spouse' then 13
	  when c.contact_type_description = 'Conservator' then 9
	  when c.contact_type_description = 'Guardian' then 10
	  when c.contact_type_description = 'Authorized Designee' then 4
	 END as Priority*/
into #rtemp
from reversequest.rms.v_LoanMaster a
join
[ReverseQuest].[rms].[v_PropertyMaster] b
on a.loan_skey=b.loan_skey
join reversequest.rms.v_ContactMaster c
on a.loan_skey = c.loan_skey
join reversequest.rms.v_Alert d
on a.loan_skey=d.loan_skey
where 
/*a.loan_status_description in ('DEFAULT', 'FORECLOSURE','Active','Claim') and
 c.contact_type_description not in('Broker',
'  Counseling Agency',
'  Contractor',
'  Debt Counselor',
'  HOA',
'  Neighbor',
'  Other',
'  Payoff Requester',
'  Relative',
'  Skip Tracing',
'  Title Company')
and ((len(c.home_phone_number)>=10 and c.home_phone_number <>'9999999999' and c.home_phone_number <> '4444444444')or (len(c.cell_phone_number)>=10 and c.cell_phone_number <> '9999999999' and c.cell_phone_number <> '4444444444') or
(len(c.work_phone_number)>=10) and c.work_phone_number <> '9999999999' and c.work_phone_number <> '4444444444')
--and d.alert_status_description = 'Active'*/
 a.loan_skey in('12733',
'13777',
'14672',
'16096',
'16400',
'16600',
'18977',
'19371',
'21879',
'22686',
'22701',
'23134',
'28320',
'29384',
'29669',
'39894',
'43023',
'43623',
'56973',
'69935',
'70155',
'70228',
'71046',
'72349',
'74353',
'78592',
'78651',
'80309',
'80326',
'80793',
'89174',
'92534',
'95817',
'98737',
'98881',
'103000',
'109993',
'112186',
'114587',
'114855',
'116964',
'117069',
'119261',
'120743',
'121486',
'122195',
'122255',
'124811',
'125904',
'129134',
'130141',
'133932',
'137534',
'145249',
'147530',
'147967',
'152264',
'159188',
'166370',
'168240',
'169916',
'170520',
'171967',
'172850',
'174677',
'175379',
'175451',
'177281',
'178966',
'180062',
'180226',
'181339',
'183220',
'183321',
'183461',
'183733',
'183768',
'183795',
'184528',
'185116',
'185274',
'185998',
'186354',
'186513',
'186890',
'186900',
'186993',
'187155',
'187198',
'187293',
'187304',
'187354',
'187355',
'187384',
'187396',
'187459',
'187478',
'187515',
'187689',
'187985',
'188027',
'188085',
'188212',
'188436',
'188508',
'188581',
'188600',
'188638',
'188743',
'188755',
'188772',
'188827',
'188846',
'189035',
'189088',
'189143',
'189148',
'200395',
'200484',
'200577',
'200586',
'200604',
'200613',
'200616',
'200690',
'200748',
'200766',
'200804',
'200835',
'200936',
'200945',
'201076',
'201090',
'201164',
'201227',
'201259',
'201415',
'201595',
'201687',
'201779',
'201791',
'202005',
'202022',
'202078',
'202107',
'202153',
'202183',
'202204',
'202268',
'202518',
'202524',
'202726',
'202737',
'202745',
'202774',
'202786',
'202824',
'203056',
'203149',
'203207',
'203235',
'203390',
'203432',
'203507',
'203584',
'203625',
'203628',
'203633',
'203637',
'203817',
'203854',
'203923',
'204035',
'204052',
'204159',
'204171',
'204341',
'204358',
'204379',
'204389',
'204422',
'204450',
'205061',
'205207',
'205263',
'205439',
'205873',
'205910',
'206404',
'206474',
'206662',
'206823',
'206946',
'207164',
'207332',
'207426',
'207570',
'207581',
'207724',
'208063',
'208167',
'208421',
'208894',
'209247',
'209279',
'209286',
'209536',
'209791',
'209819',
'209829',
'209891',
'210055',
'210220',
'210304',
'210464',
'210618',
'210730',
'210756',
'210860',
'211247',
'211649',
'211894',
'212195',
'212315',
'212499',
'212556',
'212581',
'212750',
'212928',
'213148',
'213270',
'213292',
'213313',
'214008',
'214160',
'214458',
'214500',
'214597',
'214651',
'214663',
'214742',
'214758',
'215253',
'215407',
'215581',
'215644',
'215829',
'215839',
'215982',
'215992',
'215993',
'216148',
'216190',
'216238',
'216256',
'216322',
'216439',
'217043',
'217662',
'218054',
'218547',
'219197',
'219288',
'219630',
'219979',
'220091',
'220113',
'220211',
'220237',
'220312',
'220397',
'220444',
'220449',
'220548',
'220593',
'220614',
'220635',
'220711',
'220784',
'220866',
'220925',
'220976',
'220977',
'221017',
'221145',
'221658',
'221691',
'221709',
'221715',
'221726',
'221823',
'221900',
'221939',
'221969',
'222020',
'222100',
'222165',
'222186',
'222363',
'222565',
'222570',
'222601',
'222656',
'222849',
'222862',
'222947',
'222995',
'223020',
'223110',
'223123',
'223164',
'223200',
'223223',
'223298',
'223406',
'223854',
'223891',
'223972',
'223977',
'224016',
'224027',
'224033',
'224038',
'224098',
'224120',
'224131',
'224197',
'224202',
'224234',
'224302',
'224351',
'224396',
'224509',
'224523',
'224566',
'224623',
'224739',
'224741',
'224807',
'224836',
'224854',
'224865',
'224976',
'225067',
'225072',
'225088',
'225565',
'225655',
'226144',
'227936',
'228236',
'228246',
'230149',
'230651',
'231927',
'231972',
'232266',
'233751',
'234356',
'234569',
'235432',
'236423',
'236489',
'238084',
'240615',
'240673',
'240799',
'240885',
'240990',
'241454',
'242320',
'242664',
'243883',
'244210',
'245370',
'247341',
'247885',
'253070',
'258563',
'258635',
'258909',
'258916',
'258925',
'258935',
'259128',
'259147',
'259440',
'259482',
'259499',
'259513',
'259532',
'259630',
'259638',
'259649',
'259706',
'259719',
'259727',
'259819',
'259865',
'259887',
'259964',
'259979',
'261612',
'261700',
'261744',
'261778',
'261780',
'261815',
'261822',
'262004',
'262005',
'262009',
'262027',
'262052',
'262058',
'262092',
'262103',
'262151',
'262206',
'262285',
'262313',
'262533',
'262559',
'262635',
'262667',
'262704',
'262711',
'262763',
'263025',
'263109',
'263134',
'263240',
'263357',
'263379',
'263385',
'263425',
'263553',
'263647',
'263716',
'263722',
'263733',
'263760',
'263871',
'264001',
'264035',
'264040',
'264048',
'264054',
'264072',
'264154',
'264155',
'264166',
'264194',
'264197',
'264207',
'264234',
'264240',
'264258',
'264276',
'264360',
'264398',
'264449',
'264464',
'264483',
'264488',
'264556',
'264560',
'264588',
'264592',
'264596',
'264624',
'264708',
'264836',
'264840',
'264861',
'264874',
'264877',
'264890',
'264901',
'264941',
'264983',
'264986',
'264987',
'264996',
'265011',
'265033',
'265038',
'265069',
'265085',
'265108',
'265128',
'265147',
'265167',
'265171',
'265174',
'265193',
'265312',
'265321',
'265351',
'265423',
'265461',
'265517',
'265521',
'265534',
'265535',
'265553',
'265573',
'265585',
'265589',
'265593',
'265594',
'265609',
'265610',
'265615',
'265746',
'265758',
'265786',
'265802',
'265805',
'265809',
'265839',
'265843',
'265873',
'265880',
'265889',
'265891',
'265904',
'265944',
'265947',
'265948',
'265986',
'266000',
'266041',
'266119',
'266121',
'266150',
'266156',
'266180',
'266206',
'266268',
'266274',
'266277',
'266342',
'266368',
'266390',
'266423',
'266488',
'266526',
'266528',
'266547',
'266571',
'266577',
'266582',
'266583',
'266629',
'266651',
'266689',
'266691',
'266712',
'266725',
'266745',
'266760',
'266776',
'266836',
'266876',
'266877',
'266899',
'266907',
'266914',
'266921',
'266928',
'267033',
'267041',
'267050',
'267078',
'267145',
'267155',
'267166',
'267169',
'267190',
'267235',
'267267',
'267303',
'267309',
'267314',
'267349',
'267382',
'267395',
'267401',
'267411',
'267425',
'267457',
'267467',
'267473',
'267530',
'267533',
'267547',
'267551',
'267584',
'267624',
'267634',
'267668',
'267680',
'267752',
'267764',
'267775',
'267815',
'267859',
'267866',
'267883',
'267930',
'267953',
'267954',
'267971',
'267972',
'268030',
'268059',
'268060',
'268069',
'268078',
'268127',
'268129',
'268159',
'268219',
'268249',
'268268',
'268353',
'268374',
'268420',
'268440',
'268454',
'268460',
'270549',
'270761',
'270844',
'270959',
'270980',
'271020',
'271025',
'271029',
'271040',
'271045',
'271056',
'271062',
'271072',
'271076',
'271091',
'271101',
'271115',
'271136',
'271228',
'271262',
'271268',
'271274',
'271317',
'271337',
'271420',
'271431',
'271478',
'271479',
'271552',
'272073',
'272253',
'272356',
'272370',
'272373',
'272539',
'272679',
'272821',
'272903',
'272962',
'272968',
'273024',
'273411',
'273559',
'273590',
'273931',
'273994',
'274022',
'274092',
'274099',
'274224',
'274245',
'274270',
'274294',
'274472',
'274719',
'275111',
'275264',
'275270',
'275385',
'275538',
'275598',
'275785',
'275900',
'276011',
'276095',
'276122',
'276345',
'276515',
'276600',
'276666',
'276869',
'277333',
'277537',
'277607',
'277618',
'277680',
'277909',
'278019',
'278020',
'278024',
'278248',
'278332',
'278373',
'278396',
'278406',
'278508',
'278606',
'278729',
'278939',
'279111',
'279115',
'279215',
'279310',
'279331',
'279362',
'279529',
'279805',
'280144',
'280217',
'280252',
'280255',
'280257',
'280298',
'280544',
'280610',
'280673',
'280735',
'280947',
'280988',
'281014',
'281173',
'281222',
'281235',
'281245',
'281349',
'281397',
'281444',
'281447',
'281526',
'281638',
'281814',
'282015',
'282018',
'282063',
'282082',
'282131',
'282227',
'282289',
'282335',
'282636',
'282643',
'282652',
'282664',
'282691',
'282748',
'282787',
'282907',
'282912',
'282976',
'282994',
'283265',
'283520',
'283577',
'283667',
'283729',
'284076',
'284090',
'284129',
'284148',
'284482',
'284649',
'284701',
'285463',
'285510',
'285522',
'285568',
'285585',
'285588',
'285620',
'285629',
'285810',
'285865',
'285943',
'286103',
'287913',
'289430',
'290338',
'290435',
'291166',
'292080',
'292093',
'292228',
'292534',
'292979',
'293075',
'294680',
'294797',
'296469',
'296628',
'296880',
'297957',
'297990',
'298388',
'299084',
'299166',
'299392',
'299971',
'300110',
'300212',
'301657',
'302119',
'302477',
'302562',
'302588',
'302830',
'303291',
'303373',
'303671',
'303908',
'305480',
'305487',
'305711',
'305831',
'306161',
'306187',
'306235',
'306369',
'306541',
'307912',
'307990',
'308141',
'308544',
'308948',
'309089',
'309645',
'309654',
'310096',
'311105',
'311293',
'311688',
'311940',
'312136',
'312465',
'312753',
'312763',
'312803',
'313230',
'314689',
'315863',
'316059',
'316091',
'316774',
'316926',
'317552',
'317586',
'317717',
'317762',
'318187',
'318549',
'319236',
'319624',
'319675',
'319744',
'319984',
'320762',
'321454',
'321570',
'322005',
'322040',
'322133',
'322282',
'322361',
'322598',
'322605',
'322770',
'322784',
'323103',
'323148',
'323169',
'323221',
'323222',
'323241',
'323607',
'323675',
'325048',
'325412',
'325420',
'325422',
'325424',
'325429',
'325431',
'325672',
'325675',
'514238',
'519582',
'530687',
'535214',
'537647',
'540988',
'563335')

--select * from #rtemp where loan_skey = '43270' order by Priority;

--delete from #rtemp where Priority is null;
/*
IF OBJECT_ID('tempdb..#rtemp1') IS NOT NULL
    DROP TABLE #rtemp1;
select * into #rtemp1 from 
(select ROW_NUMBER() OVER (PARTITION BY loan_skey ORDER BY priority) rn,* from #rtemp) q
WHERE   rn = 1
order by loan_skey

--select * from #rtemp1 where loan_skey = '43623' order by Priority;

delete  from #rtemp1 where loan_skey  in(
select loan_skey from [ReverseQuest].[rms].[v_Alert]
where alert_type_description  in ('FDCPA -  Call Restrictions','Cease and Desist',
'Pending Cease and Desist',
'Litigation -  Proceed','LITIGATION - Lawsuit Pending',
'DVN Research Request Pend','SKPADD','SKPEML','SKPEXH','SKPTRC')
and alert_status_description = 'Active')



delete  from #rtemp1 where loan_skey  in
(select b.loan_skey
  --,a.workflow_instance_skey,a.complete_date
  FROM [ReverseQuest].[rms].[v_WorkflowTaskActivity] a join [ReverseQuest].[rms].[v_WorkflowInstance] b
  on a.workflow_instance_skey=b.workflow_instance_skey
  where a.workflow_task_description ='3rd Party Sale'
  and a.complete_date is not null);
*/
  --select * from #rtemp where loan_skey = '88061' order by Priority;
  --select * from #rtemp1 where Priority is null;
  --delete from #rtemp where Priority is null;

  

IF OBJECT_ID('tempdb..#rtemp2') IS NOT NULL
    DROP TABLE #rtemp2;
select a.*
,e.default_reason as 'default reason'
,e.created_date 
into #rtemp2
from
#rtemp a
left join reversequest.rms.v_MonthlyLoanDefaultSummary e
on a.loan_skey=e.loan_skey;

--select distinct * from #rtemp2 where loan_skey = '46836';

  
 /* delete from #rtemp2
where loan_skey in
(select a.loan_skey from reversequest.rms.v_note a
where a.created_date
>= DATEADD(d,-7,DATEDIFF(d,0,GETDATE())) and
a.created_date < DATEADD(d,0,DATEDIFF(d,0,GETDATE()))
and (a.note_type_description like '%Incom%' or note_type_description like 'Spoc Incom%'));*/

IF OBJECT_ID('tempdb..#rtemp3') IS NOT NULL
    DROP TABLE #rtemp3;
select loan_skey,loan_sub_status,investor_name
--,loan_status_description,
,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,[Property Address1]
,[Property Address2], [Property City],[Property State],[Property Zip],[Mailing Address 1],[Mailing Address 2],[Mailing City],[Mailing State],[Mailing Zip]
,HOMEPHONE1,CELLPHONE1, [Work Phone #] 
--,alert_type_description
,[default reason],loan_status_description
--,Priority 
into #rtemp3
from 
(select ROW_NUMBER() OVER (PARTITION BY loan_skey ORDER BY created_date desc) rownum,* from #rtemp2) x
WHERE  
rownum = 1 --and 
--Priority is not null 
--and loan_skey = '89192'
order by loan_skey,alert_type_description;

/*update #rtemp3 set HOMEPHONE1='',CELLPHONE1=''
where CONTACTTYPE1 = 'Attorney';*/

alter table  #rtemp3
add 
CONTACTTYPE2 NVARCHAR(100),
CONTACTFIRSTNAME2 NVARCHAR(200),
CONTACTLASTNAME2 NVARCHAR(200),
HOMEPHONE2 NVARCHAR(20),
CELLPHONE2 NVARCHAR(20),
CONTACTTYPE3 NVARCHAR(100),
CONTACTFIRSTNAME3 NVARCHAR(200),
CONTACTLASTNAME3 NVARCHAR(200),
HOMEPHONE3 NVARCHAR(20),
CELLPHONE3 NVARCHAR(20),
CONTACTTYPE4 NVARCHAR(100),
CONTACTFIRSTNAME4 NVARCHAR(200),
CONTACTLASTNAME4 NVARCHAR(200),
HOMEPHONE4 NVARCHAR(20),
CELLPHONE4 NVARCHAR(20)
;

IF OBJECT_ID('tempdb..#tmpContacts') IS NOT NULL
    DROP TABLE #tmpContacts;
select distinct loan_skey,loan_sub_status,investor_name,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,Priority
into #tmpContacts
from #rtemp;

delete a from #tmpContacts a
join  #rtemp3 b on a.loan_skey=b.loan_skey and a.CONTACTFIRSTNAME1=b.CONTACTFIRSTNAME1;

update a set a.CONTACTTYPE2 = b.CONTACTTYPE1,
a.CONTACTFIRSTNAME2=b.CONTACTFIRSTNAME1,
a.CONTACTLASTNAME2=b.CONTACTLASTNAME1,
a.HOMEPHONE2 = b.HOMEPHONE1,
a.CELLPHONE2=b.CELLPHONE1
from #rtemp3 a
join
(select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
from (select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
,row_number() over(partition by loan_skey order by loan_skey
) as crn
from #tmpContacts) T where crn=1
) b
on a.loan_skey=b.loan_skey;


delete a from #tmpContacts a
join #rtemp3 b on a.loan_skey=b.loan_skey and a.CONTACTFIRSTNAME1=b.CONTACTFIRSTNAME2;

update a set a.CONTACTTYPE3 = b.CONTACTTYPE1,
a.CONTACTFIRSTNAME3=b.CONTACTFIRSTNAME1,
a.CONTACTLASTNAME3=b.CONTACTLASTNAME1,
a.HOMEPHONE3 = b.HOMEPHONE1,
a.CELLPHONE3=b.CELLPHONE1
from #rtemp3 a
join
(select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
from (select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
,
row_number() over(partition by loan_skey order by loan_skey) as crn
from #tmpContacts) T where crn=1
) b
on a.loan_skey=b.loan_skey;

delete a from #tmpContacts a
join #rtemp3 b on a.loan_skey=b.loan_skey and a.CONTACTFIRSTNAME1=b.CONTACTFIRSTNAME3;

update a set a.CONTACTTYPE4 = b.CONTACTTYPE1,
a.CONTACTFIRSTNAME4=b.CONTACTFIRSTNAME1,
a.CONTACTLASTNAME4=b.CONTACTLASTNAME1,
a.HOMEPHONE4 = b.HOMEPHONE1,
a.CELLPHONE4=b.CELLPHONE1
from #rtemp3 a
join
(select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
from (select loan_skey,CONTACTTYPE1,CONTACTFIRSTNAME1,CONTACTLASTNAME1,HOMEPHONE1,CELLPHONE1--,priority
,
row_number() over(partition by loan_skey order by loan_skey) as crn
from #tmpContacts) T where crn=1
) b
on a.loan_skey=b.loan_skey;

update #rtemp3 
set 
investor_name=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(investor_name, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
loan_sub_status= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(loan_sub_status, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTTYPE1= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTTYPE1, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTFIRSTNAME1=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTFIRSTNAME1, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTLASTNAME1= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTLASTNAME1, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
[Property Address1]= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Property Address1], '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
[Property Address2] = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Property Address2], '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
[Mailing Address 1]= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Mailing Address 1], '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
[Mailing Address 2] = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Mailing Address 2], '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTTYPE2= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTTYPE2, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTFIRSTNAME2= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTFIRSTNAME2, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTLASTNAME2 =REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTLASTNAME2, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTTYPE3= REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTTYPE3, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTFIRSTNAME3=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTFIRSTNAME3, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTLASTNAME3=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTLASTNAME3, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTTYPE4=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTTYPE4, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTFIRSTNAME4=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTFIRSTNAME4, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿',''),
CONTACTLASTNAME4=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CONTACTLASTNAME4, '&', ''), ',', ''), '''', ''),'"',''),'.',''),'?',''),':',''),';',''),'/',''),'>',''),'<',''),'*',''),'^',''),'$',''),'#',''),'!',''),'-',''),'@',''),'%',''),'(',''),')',''),'[',''),']',''),'{',''),'}',''),'\',''),'|',''),'¿','')


select loan_skey as LOANSKEY,loan_sub_status as LOANSUBSTATUS, investor_name as INVESTORNAME,CONTACTTYPE1 as CONTACTTYPE1
,CONTACTFIRSTNAME1 as CONTACTFIRSTNAME1,CONTACTLASTNAME1 as CONTACTLASTNAME1,[Property Address1] as PROPERTYADDRESS1
,[Property Address2] as PROPERTYADDRESS2,[Property City] as PROPERTYCITY,[Property State] as PROPERTYSTATE,[Property Zip] as PROPERTYZIP
,[Mailing Address 1] as MAILINGADDRESS1,[Mailing Address 2] as MAILINGADDRESS2, [Mailing City] as MAILINGCITY,[Mailing State] as MAILINGSTATE
,[Mailing Zip] as MAILINGZIP,HOMEPHONE1 as HOMEPHONE1, CELLPHONE1 as CELLPHONE1,
CONTACTTYPE2,CONTACTFIRSTNAME2,CONTACTLASTNAME2,HOMEPHONE2,CELLPHONE2
,CONTACTTYPE3,CONTACTFIRSTNAME3,CONTACTLASTNAME3,HOMEPHONE3,CELLPHONE3
,CONTACTTYPE4,CONTACTFIRSTNAME4,CONTACTLASTNAME4,HOMEPHONE4,CELLPHONE4
,[default reason] as CALLREASON,loan_status_description
from #rtemp3;





